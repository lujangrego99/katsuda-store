# Ralph Progress Log
Started: 2026-01-21

## Codebase Patterns
- Monorepo con pnpm workspaces: apps/web (Next.js), apps/api (Express), packages/shared (tipos)
- Colores Katsuda en Tailwind: katsuda-900 (#1B5E20), katsuda-700 (#2E7D32), katsuda-500 (#4CAF50)
- Express usa tipos explícitos: Express, Request, Response de 'express'
- Express Router requiere tipo explícito: `const router: RouterType = Router()` para evitar TS2742
- shadcn/ui: Componentes en `@/components/ui/`, configuración en `components.json`
- Layout global: Header y Footer en layout.tsx, contenido específico en page.tsx
- API routes organizadas en `apps/api/src/routes/`, integradas en index.ts con `app.use()`

---

## 2026-01-21 22:XX - E0-S01: Crear estructura del proyecto monorepo

**Qué se implementó:**
- Monorepo con pnpm workspaces configurado
- apps/web: Next.js 14 con App Router, Tailwind, TypeScript
- apps/api: Express + TypeScript (Prisma pendiente para E0-S02)
- packages/shared: Tipos compartidos (Product, Category, Cart, Order, etc.)
- docker-compose.yml para desarrollo
- Dockerfiles para ambos servicios
- Colores de Katsuda en tailwind.config.ts

**Archivos creados:**
- pnpm-workspace.yaml
- package.json (raíz)
- apps/web/* (Next.js completo)
- apps/api/* (Express básico)
- packages/shared/* (tipos)
- docker-compose.yml
- .gitignore
- README.md

**Aprendizajes para futuras iteraciones:**
- TypeScript en Express requiere tipos explícitos para evitar TS2742
- pnpm workspaces requiere "workspace:*" en dependencias internas
- Next.js standalone output necesita estructura específica en Dockerfile

**Commit:** d2a40e1
---

## 2026-01-21 23:XX - E0-S02: Configurar conexión a PostgreSQL con Prisma

**Qué se implementó:**
- Schema Prisma con modelo Category placeholder
- Archivo .env con DATABASE_URL
- Conexión verificada con prisma db push
- Health endpoint verifica conexión a BD

**Archivos creados/modificados:**
- apps/api/src/prisma/schema.prisma (nuevo)
- apps/api/.env (nuevo - no commiteado)
- apps/api/src/index.ts (actualizado)

**Aprendizajes:**
- prisma db push sincroniza schema sin crear migraciones (útil para desarrollo rápido)
- .env debe estar en apps/api/ no en la raíz

**Commit:** 3b831f4
---

## 2026-01-21 23:XX - E0-S03: Crear CLAUDE.md del proyecto

**Qué se implementó:**
- .claude/CLAUDE.md con documentación completa
- Stack, comandos, estructura del proyecto
- Colores Katsuda con tabla de referencia
- Convenciones de código
- Webhooks de deploy de Easypanel

**Archivos creados:**
- .claude/CLAUDE.md

**Commit:** be89466
---

## 2026-01-21 23:XX - E1-S01/S02/S03: Schema completo de Prisma

**Qué se implementó:**
- Schema completo con todos los modelos del e-commerce
- Category con jerarquía padre/hijo
- Brand para marcas
- Product con precios múltiples (normal, transferencia, comparación)
- ProductImage y ProductAttribute
- Customer, Address para clientes
- Cart, CartItem con soporte anónimo (sessionId)
- Order, OrderItem con estados y guest checkout
- Admin con roles (SUPER, ADMIN, STAFF)
- Contact para mensajes
- ShippingZone para zonas de envío
- Settings singleton para configuración

**Archivos modificados:**
- apps/api/src/prisma/schema.prisma (expandido completamente)

**Aprendizajes:**
- Usar prisma db push para desarrollo rápido (sin crear archivos de migración)
- Los índices son importantes para relaciones frecuentes
- Settings con @id @default("singleton") para configuración única

**Commit:** ef12bfa
---

## 2026-01-22 - E1-S04: Seed de datos iniciales

**Qué se implementó:**
- Script seed.ts completo con upsert para idempotencia
- Categorías: Griferías (con subcategorías Cocina, Baño, Ducha), Sanitarios, Termotanques, Bombas, Hogar, Instalaciones
- Marcas: FV, Piazza, Ferrum, Roca, Aqua, DECA
- 14 productos de ejemplo con imágenes Unsplash, precios, atributos
- Admin por defecto: admin@katsuda.com.ar / katsuda2024
- Settings con info de Katsuda: teléfonos, direcciones, horarios, redes sociales
- 4 zonas de envío: Gran Mendoza, Interior Mendoza, San Juan Capital, Interior San Juan

**Archivos creados:**
- apps/api/src/prisma/seed.ts

**Aprendizajes para futuras iteraciones:**
- Usar upsert para seeds idempotentes (se puede correr múltiples veces)
- Crear IDs explícitos para entidades relacionadas para poder hacer upsert en images/attributes
- Settings singleton usa id: 'singleton' como clave única

**Commit:** 3a3f2d0
---

## 2026-01-22 - E2-S01: Layout base y navegación del frontend

**Qué se implementó:**
- Instalación y configuración de shadcn/ui con variables CSS de colores Katsuda
- Componentes UI base: Button, Input, Sheet (para menú móvil)
- Header con:
  - Top bar con teléfono y botón WhatsApp
  - Logo Katsuda con slogan
  - Navegación de categorías (desktop)
  - Menú hamburguesa (mobile) usando Sheet de Radix
  - Buscador expandible (mobile) y fijo (desktop)
  - Icono de carrito con badge de cantidad
- Footer con:
  - Descripción de la empresa
  - Info de sucursales Mendoza y San Juan (dirección, teléfono, horarios)
  - Links útiles y marcas que trabajan
  - Redes sociales (Facebook, Instagram)
  - Copyright y email
- Layout integrado en Next.js App Router (layout.tsx)
- Diseño responsive mobile-first

**Archivos creados:**
- apps/web/components.json (config shadcn/ui)
- apps/web/src/components/ui/button.tsx
- apps/web/src/components/ui/input.tsx
- apps/web/src/components/ui/sheet.tsx
- apps/web/src/components/Header.tsx
- apps/web/src/components/Footer.tsx

**Archivos modificados:**
- apps/web/package.json (nuevas dependencias: @radix-ui/react-slot, @radix-ui/react-dialog, class-variance-authority, tailwindcss-animate)
- apps/web/tailwind.config.ts (añadido darkMode, variables CSS shadcn, animaciones)
- apps/web/src/styles/globals.css (variables CSS para shadcn/ui con colores Katsuda)
- apps/web/src/app/layout.tsx (integrado Header y Footer)
- apps/web/src/app/page.tsx (simplificado, solo contenido)

**Aprendizajes para futuras iteraciones:**
- shadcn/ui puede configurarse manualmente creando components.json y copiando componentes
- Las variables CSS de shadcn/ui usan formato HSL sin "hsl()" wrapper: `122 76% 23%`
- Usar Sheet de Radix para menús móviles, es más accesible que un drawer casero
- El layout de Next.js con flex-col y flex-1 en main asegura que el footer quede abajo

**Commit:** 6435c12
---

## 2026-01-22 - E2-S02: API de productos y categorías

**Qué se implementó:**
- Rutas organizadas en `apps/api/src/routes/` (categories, brands, products)
- GET /api/categories - Lista categorías padre con hijos y conteo de productos
- GET /api/categories/:slug - Categoría con productos paginados (incluye hijos)
- GET /api/brands - Lista marcas activas con conteo de productos
- GET /api/products - Lista paginada con filtros: category, brand, priceMin, priceMax, inStock, freeShipping, search, sortBy (newest, price_asc, price_desc, name_asc, name_desc)
- GET /api/products/:slug - Detalle completo con imágenes, atributos, categoría con parent, marca y productos relacionados
- GET /api/products/featured - Productos destacados con límite configurable

**Archivos creados:**
- apps/api/src/routes/categories.ts
- apps/api/src/routes/brands.ts
- apps/api/src/routes/products.ts

**Archivos modificados:**
- apps/api/src/index.ts (integración de routers)

**Aprendizajes para futuras iteraciones:**
- Router de Express requiere tipo explícito: `const router: RouterType = Router()` para evitar TS2742
- Rutas con parámetros dinámicos (/:slug) deben ir DESPUÉS de rutas específicas (/featured)
- Usar `include: { _count: { select: { products: ... } } }` para conteo eficiente en Prisma

**Commit:** c948bbc
---
